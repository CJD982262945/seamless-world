<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="1139" height="870" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[Title: 账号登录
Client->Login:请求登录
Login-->第3方账号平台:1. 请求验证帐号密码
第3方账号平台-->Login:返回验证结果
Login-->Client:返回结果1：帐号密码错误
Login->DB(Redis):2. 若第1步OK，则请求获取帐号数据
DB(Redis)-->Login:返回帐号数据
Login->DB(Redis):如果没有帐号数据，请求创建帐号数据
DB(Redis)-->Login:返回创建帐号结果
Login-->Client:返回结果2：帐号创建失败
Note right of Login: 3. 若第2步OK，则生成Token
Login->RedisForServer(Redis):缓存Token
RedisForServer(Redis)-->Login:返回缓存结果
Login-->Client:返回结果3：Token生成失败
Login->SingletonRedis(Redis): 4. 若第3步OK，获取Gateway列表
SingletonRedis(Redis)-->Login: 返回Gateway列表结果
Note right of Login: 选取Gateway
Login-->Client:返回结果0：帐号验证成功]]></source><desc>账号登录</desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"><rect x="10" y="10" width="77" height="30" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="17" y="31" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="15">账号登录</tspan></text></g><g class="actor"><rect x="10" y="50" width="70" height="40" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="22" y="76" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="20">Client</tspan></text></g><g class="actor"><rect x="10" y="810" width="70" height="40" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="22" y="836" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="20">Client</tspan></text></g><line x1="45" x2="45" y1="90" y2="810" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="228" y="50" width="64" height="40" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="240" y="75" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="238">Login</tspan></text></g><g class="actor"><rect x="228" y="810" width="64" height="40" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="240" y="835" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="238">Login</tspan></text></g><line x1="260" x2="260" y1="90" y2="810" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="450" y="50" width="126" height="40" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="462" y="76" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="460">第3方账号平台</tspan></text></g><g class="actor"><rect x="450" y="810" width="126" height="40" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="462" y="836" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="460">第3方账号平台</tspan></text></g><line x1="513" x2="513" y1="90" y2="810" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="596" y="50" width="94" height="40" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="608" y="76" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="606">DB(Redis)</tspan></text></g><g class="actor"><rect x="596" y="810" width="94" height="40" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="608" y="836" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="606">DB(Redis)</tspan></text></g><line x1="643" x2="643" y1="90" y2="810" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="710" y="50" width="190" height="40" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="722" y="76" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="720">RedisForServer(Redis)</tspan></text></g><g class="actor"><rect x="710" y="810" width="190" height="40" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="722" y="836" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="720">RedisForServer(Redis)</tspan></text></g><line x1="805" x2="805" y1="90" y2="810" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="920" y="50" width="189" height="40" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="931" y="75.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="930">SingletonRedis(Redis)</tspan></text></g><g class="actor"><rect x="920" y="810" width="189" height="40" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="931" y="835.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="930">SingletonRedis(Redis)</tspan></text></g><line x1="1014.5" x2="1014.5" y1="90" y2="810" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="signal"><text x="121" y="121" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="119">请求登录</tspan></text><line x1="45" x2="260" y1="130" y2="130" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="310.5" y="161" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="309.5">1. 请求验证帐号密码</tspan></text><line x1="260" x2="513" y1="170" y2="170" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="339" y="201" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="337">返回验证结果</tspan></text><line x1="513" x2="260" y1="210" y2="210" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="61" y="241" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="59">返回结果1：帐号密码错误</tspan></text><line x1="260" x2="45" y1="250" y2="250" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="323.5" y="281" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="322.5">2. 若第1步OK，则请求获取帐号数据</tspan></text><line x1="260" x2="643" y1="290" y2="290" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="404" y="321" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="402">返回帐号数据</tspan></text><line x1="643" x2="260" y1="330" y2="330" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="316" y="361" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="314">如果没有帐号数据，请求创建帐号数据</tspan></text><line x1="260" x2="643" y1="370" y2="370" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="388" y="401" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="386">返回创建帐号结果</tspan></text><line x1="643" x2="260" y1="410" y2="410" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="61" y="441" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="59">返回结果2：帐号创建失败</tspan></text><line x1="260" x2="45" y1="450" y2="450" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="280" y="470" width="213" height="30" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="286" y="491" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="285">3. 若第2步OK，则生成Token</tspan></text></g><g class="signal"><text x="496.5" y="531" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="494.5">缓存Token</tspan></text><line x1="260" x2="805" y1="540" y2="540" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="485" y="571" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="483">返回缓存结果</tspan></text><line x1="805" x2="260" y1="580" y2="580" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="57" y="611" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="55">返回结果3：Token生成失败</tspan></text><line x1="260" x2="45" y1="620" y2="620" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="521.25" y="651" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="520.25">4. 若第3步OK，获取Gateway列表</tspan></text><line x1="260" x2="1014.5" y1="660" y2="660" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="561.75" y="691" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="559.75">返回Gateway列表结果</tspan></text><line x1="1014.5" x2="260" y1="700" y2="700" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="280" y="720" width="102" height="30" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="287" y="741" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="285">选取Gateway</tspan></text></g><g class="signal"><text x="61.5" y="781" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="59.5">返回结果0：帐号验证成功</tspan></text><line x1="260" x2="45" y1="790" y2="790" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g></svg>