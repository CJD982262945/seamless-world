# 战斗交互方案

## 一些确定性的东西

    - 攻击方必定都是Real
    - 能攻击到的目标要么是Ghost要么是Real，肯定都是在自己所在的cell里有实体的
        + Real，Ghost 都是实体
    - Ghost的属性变化不会同步给Real


## 一次攻击（或者说技能）处理流程

    1. 攻击方攻击防御方（无论是否是Real）的数据直接计算属性、状态的变化，直接双方生效
    2. 如果防御方是Ghost，会记录这次属性和状态的变化，同步这次变化到Real
        - 同步变化量到real
        - 目前死亡状态不会同步到real，因为可能有另一人给目标先加血了，导致这次不能致死
        - real应用变化量后同步最终值到ghost
    3. 对于Buff，全部转由Real管理，其它Ghost不处理
    4. 防御方属性和状态的本地修改肯定被Real最终同步覆盖掉
    5. 如果Ghost发生销毁，会将Ghost上未结束的Buff同步到Real

## 问题

    1. 假设来自两个CELL的处理结果，一个是加血，一个是死亡，最终服务器认定是死亡，那客户端在表现时是否会有问题？
        - 死亡后过滤掉这些表现？

## 讨论

* 一个技能给周围10m范围内所有人加Buff, 找到10个目标。
  因为加Buff须转发到Real去，不会立即返回，那么，
  这个技能的处理是否应该独立一个协程处理？
  或者10个目标分成10个协程处理？
