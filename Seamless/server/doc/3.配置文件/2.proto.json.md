## 自动生成

proto.json 是由 TimeFire/protoFile/gen.py

根据 TimeFire/protoFile/game.proto 和 TimeFire/protoFile/route 自动生成的。

请勿手动修改


## 生成位置

  - TimeFire/server/res/config/proto.json

## 同步客户端

客户端登录后，Gateway会发送proto.json给客户端。

因此需要知道proto.json的位置。

在TimeFire/server/res/config/server.json.example中的 Gateway.ProtoFile 字段中配置。


同步proto.json相关代码:

```go
// Init 初始化
func (srv *GatewaySrv) Init() error {

	// ...(略)...

	// 读取Proto消息二进制数据
	if err := srv.genProtoSync(); err != nil {
		log.Error("start gateway error", err)
		return err
	}

	// ...(略)...
}

// 获取ProtoFile内容
func (srv *GatewaySrv) genProtoSync() error {
	srv.protoSync = &msgdef.ProtoSync{}
	protoFile := viper.GetString("Gateway.ProtoFile")
	data, err := ioutil.ReadFile(protoFile)
	if err != nil {
		return err
	}
	srv.protoSync.Data = data
	return nil
}

// 登录完全成功之后的操作
// typ: 登录类型, 正常登陆/断线重连/重复登录
func (user *GateUser) onLoginSuccessFinal() {
	// ...(略)...

	sess.Send(GetSrvInst().protoSync)

	// ...(略)...
}
```
