## 简介

JS网页测试工具

目前接通登录到进入游戏场景

具体玩法需要时，服务器可以在它基础上，增加一些测试功能

## 环境搭建、编译运行

参见：[server/tools/h5client/README.md](../../tools/h5client/README.md)

## 登录到进入游戏场景的协议流程

参见：[1.协议清单.md](1.协议清单.md)

## 代码结构介绍

```tree
app
├─message
│  ├─proto
│  │      g.bat
│  │      game_pb.js
│  │      protoc.exe
│  │
│  ├─rpc
│  │      serialize.js
│  │      unserialize.js
│  │
│  └─struct
│      │  AdjustUserState.js
│      │  AOISyncUserState.js
│      │  ClientVertifyFailedRet.js
│      │  ClientVertifyReq.js
│      │  ClientVertifySucceedRet.js
│      │  EnterSpace.js
│      │  EntityAOIS.js
│      │  MRolePropsSyncClient.js
│      │  ProtoSync.js
│      │  RPCMsg.js
│      │  SpaceEntityMsg.js
│      │  SpaceUserConnect.js
│      │  SyncUserState.js
│      │
│      └─unpacker
├─models
│      entity.js
│      eventinfo_enteraoi.js
│      eventinfo_leaveaoi.js.js
│      gateway.js
│      lobby.js
│      login.js
│      room.js
│      user.js
│      v2d.js
│      v2d_camera.js
│
├─pages
│      lobby.controller.js
│      lobby.html
│      login.controller.js
│      login.html
│      maploading.controller.js
│      maploading.html
│      page.js
│      room.controller.js
│      room.html
│      stage.controller.js
│      stage.html
```

上图，列出了主要代码结构。依次为：

| 目录名                | 说明                       |
| ------------------ | ------------------------ |
| app/message/proto  | proto协议，使用 g.bat 生成 js代码 |
| app/message/rpc    | rpc参数序列化、反序列类            |
| app/message/struct | struct协议文件               |
| app/models         | 主要逻辑处理                   |
| app/pages          | 各界面                      |

app/models各文件介绍：

| 文件名                   | 说明            |
| --------------------- | ------------- |
| gateway.js            | gateway相关协议处理 |
| lobby.js              | lobby界面相关处理   |
| login.js              | login界面相关处理   |
| room.js               | 游戏场景界面相关处理    |
| user.js               | 玩家类           |
| entity.js             | entity信息      |
| eventinfo_enteraoi.js | AOI进入事件       |
| eventinfo_leaveaoi.js | AOI离开事件       |
| v2d.js                | 2D绘制游戏场景      |
| v2d_camera.js         | 2D视图处理        |

app/pages各文件介绍

| 文件名                    | 说明       |
| ------------------------ | -------- |
| lobby.html               | 大厅界面     |
| lobby.controller.js      | 大厅界面事件处理 |
| login.html               | 登录界面     |
| login.controller.js      | 登录界面事件处理 |
| room.html                | 游戏场景界面   |
| room.controller.js       | 游戏场景事件处理 |
| maploading.html          | 地图加载界面   |
| maploading.controller.js | 地图加载事件处理 |
| page.js                  | 界面管理类    |
| stage.html               | 完整界面     |
| stage.controller.js      | 完整界面事件处理 |

## 如何基于H5Client编写一些测试

1.  如果登录流程有调整，则参考[1.协议清单.md](1.协议清单.md)，调整下，接下新登录流程

2.  其他的对应界面上加些按钮或文本
3.  对应消息处理增加处理消息
